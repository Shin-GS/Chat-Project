<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<body>
<ul th:fragment="conversation-list"
    id="conversation-list"
    hx-swap-oob="true"
    class="divide-y divide-gray-200 text-sm sm:text-base max-h-64 lg:max-h-[60vh] overflow-y-auto pr-1">
    <!--/*@thymesVar id="conversations" type="java.util.List<com.chat.server.service.conversation.response.ConversationInfoResponse>"*/-->
    <!--/*@thymesVar id="conversation" type="com.chat.server.service.conversation.response.ConversationInfoResponse"*/-->
    <li th:if="${#lists.isEmpty(conversations)}"
        class="py-4 text-center text-gray-500">
        No conversations yet
    </li>

    <li th:each="conversation : ${conversations}"
        class="py-2 px-2 sm:px-3 flex items-center justify-between gap-3 hover:bg-gray-50 transition-colors">
        <div class="flex flex-col min-w-0 flex-1">
            <button type="button"
                    th:attr="hx-get='/hx/conversations/' + ${conversation.id} + '/panel'"
                    hx-swap="none"
                    class="text-left w-full font-medium text-blue-700 hover:underline focus:outline-none focus:ring-2 focus:ring-blue-500 rounded">
                <span th:text="${conversation.title != null ? conversation.title : 'Untitled conversation'}"
                      class="truncate">
                    Untitled conversation
                </span>
            </button>

            <!-- Type (English label by enum title) -->
            <span class="text-xs text-gray-500 mt-0.5"
                  th:text="${
                      conversation.type.name() == 'ONE_TO_ONE' ? '1:1 chat' :
                      (conversation.type.name() == 'GROUP' ? 'Group chat' : 'Other')
                  }">Type</span>

            <!-- Last activity -->
            <span class="text-xs text-gray-400"
                  th:text="${#temporals.format(conversation.lastActivityAt, 'MMM d, yyyy HH:mm')}">
                Last activity
            </span>
        </div>

        <button type="button"
                th:attr="hx-post='/hx/conversations/' + ${conversation.id} + '/leave'"
                hx-swap="none"
                class="inline-flex items-center justify-center bg-red-100 hover:bg-red-200 text-red-700 font-semibold px-3 py-1.5 rounded text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors">
            Leave
        </button>
    </li>
</ul>
</body>
</html>
