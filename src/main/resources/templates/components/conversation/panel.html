<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<body>
<!--/*@thymesVar id="user" type="com.chat.server.service.user.response.UserInfoResponse"*/-->
<!--/*@thymesVar id="conversation" type="com.chat.server.service.conversation.response.ConversationInfoResponse"*/-->
<div th:fragment="conversation-panel"
     class="flex-1 p-4"
     id="conversation-panel"
     hx-swap-oob="true"
     th:attr="data-user-id=${user.id}, data-conversation-id=${conversation.id}">
    <div>
        <div class="conversation-topbar">
            <h2 id="conversation-title" th:text="${conversation.title}">Conversation</h2>
            <button id="conversation-leave-button"
                    th:attr="hx-post='/hx/conversations/' + ${conversation.id} + '/leave'"
                    type="button"
                    hx-swap="none"
                    title="Leave this chat">
                Leave
            </button>
        </div>

        <!--/*@thymesVar id="participants" type="java.util.List<com.chat.server.service.conversation.response.ConversationParticipantInfoResponse>"*/-->
        <section id="conversation-participant-list"></section>
        <div hidden="hidden"
             id="refresh-conversation-participant-list"
             hx-trigger="load, refresh from:body"
             th:attr="hx-get='/hx/conversations/' + ${conversation.id} + '/participants'"
             hx-swap="none"></div>

        <div hidden="hidden"
             id="initial-loader"
             th:attr="hx-get='/hx/conversations/' + ${conversation.id} + '/before'"
             hx-trigger="load"
             hx-target="#conversation-message-list"
             hx-swap="afterbegin"></div>

        <div id="conversation-message-list"
             style="height: 400px; overflow-y: auto; border: 1px solid #ccc;"></div>

        <div class="conversation">
            <label for="conversation-input">
                <input type="text"
                       id="conversation-input"
                       placeholder="Type a message..."
                       style="width: 80%;"/>
            </label>
            <button id="conversation-send-button" type="button">Send</button>
        </div>
    </div>
</div>
</body>
</html>
