<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:hx-on="http://www.w3.org/1999/xhtml"
      lang="en"
      th:lang="${#locale.toLanguageTag()}">
<body>
<div th:fragment="role-modal"
     id="modal-container"
     hx-swap-oob="true">
    <div class="fixed inset-0 bg-transparent flex items-center justify-center z-50 p-4">
        <div class="bg-white w-full max-w-md rounded-xl shadow-2xl relative px-6 py-8 sm:px-8 sm:py-10">
            <button onclick="document.getElementById('modal-container').innerHTML=''"
                    class="absolute top-3 right-3 text-gray-400 hover:text-red-500 text-2xl font-bold transition-colors"
                    aria-label="Close">
                &times;
            </button>

            <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-5">Change User Role</h2>

            <!--/*@thymesVar id="nowRole" type="com.chat.server.common.constant.conversation.ConversationUserRole"*/-->
            <!--/*@thymesVar id="conversationId" type="com.chat.server.domain.vo.ConversationId"*/-->
            <!--/*@thymesVar id="userId" type="com.chat.server.domain.vo.UserId"*/-->
            <form class="space-y-4"
                  th:with="roles=${T(com.chat.server.common.constant.conversation.ConversationUserRole).values()}"
                  th:attr="hx-put=@{|/hx/conversations/groups/role/${conversationId}/${userId}|}"
                  hx-target="body"
                  hx-swap="none"
                  hx-on::after-request="if (event.detail.successful) { document.getElementById('modal-container').innerHTML=''; }">
                <div role="radiogroup" aria-label="Select a role" class="space-y-2">
                    <label th:each="role : ${roles}"
                           class="flex items-start gap-3 p-3 border border-gray-200 rounded-lg transition-colors"
                           th:classappend="${role == nowRole} ? ' opacity-60 cursor-not-allowed' : ' hover:border-gray-300 hover:bg-gray-50'">
                        <input type="radio"
                               name="role"
                               th:value="${role}"
                               th:disabled="${role == nowRole}"
                               required
                               class="mt-1 h-4 w-4 accent-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <div>
                            <!--/*@thymesVar id="roleName" type="com.chat.server.common.constant.conversation.ConversationUserRole"*/-->
                            <div class="font-semibold text-gray-900" th:text="${role.getRoleName()}">Role Name</div>
                            <div class="text-xs text-gray-500" th:text="${role.getDescription()}">Description</div>
                            <div class="text-xs text-red-500 mt-1" th:if="${role == nowRole}">Current Role</div>
                        </div>
                    </label>
                </div>
                <p class="text-xs text-gray-500">You can select only one role. Your current role cannot be selected.</p>
                <div class="text-right space-x-2 pt-1">
                    <button type="button"
                            class="inline-flex items-center justify-center bg-gray-200 hover:bg-gray-300 text-gray-800 text-sm font-medium px-4 py-2 rounded-md transition-colors"
                            onclick="document.getElementById('modal-container').innerHTML=''">
                        Close
                    </button>
                    <button type="submit"
                            class="inline-flex items-center justify-center bg-black hover:bg-gray-900 text-white text-sm font-medium px-4 py-2 rounded-md shadow transition-colors">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>
